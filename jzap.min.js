var e=!0,f=null,h=!1;function i(){return function(){}}var l,aa=this;function n(a,b){var c=a.split("."),d=aa;!(c[0]in d)&&d.execScript&&d.execScript("var "+c[0]);for(var g;c.length&&(g=c.shift());)!c.length&&void 0!==b?d[g]=b:d=d[g]?d[g]:d[g]={}};function ba(){var a=o;this.zb=a;this.wb=a.getContext("2d");this.width=a.width;this.height=a.height;this.wb.font="16px sans-serif"};function p(){this.ib=-1;this.hb=this.Ea=h;this.A=[];this.gb=this.Pa.bind(this);this.jb=this.Qa.bind(this);document.addEventListener("keydown",this.gb,h);document.addEventListener("keyup",this.jb,h)}p.prototype.e=i();p.prototype.Pa=function(a){this.Ea=e;for(var b=this.A.length,c=0;c<b;++c)if(this.A[c]===a.keyCode)return;this.A.push(a.keyCode)};
p.prototype.Qa=function(a){this.ib=a.keyCode;this.Ea=h;this.hb=e;for(var b=this.A.length,c=-1,d=0;d<b;++d)if(this.A[d]===a.keyCode){c=d;break}0<=c&&this.A.splice(c,1)};function q(a,b){this.x=a||0;this.y=b||0};function r(a){this.F=[];this.F.push(h);this.F.push(h);this.Ga=this.nb=h;this.G=new q;this.ba=new q;this.X=new q;this.Y=new q;this.v=a;if(a.offsetParent){do{var b=this.Y,c=new q(a.offsetLeft,a.offsetTop);b.x+=c.x;b.y+=c.y}while(a=a.offsetParent)}this.mb=this.Ra.bind(this);this.qb=this.Ta.bind(this);this.tb=this.Wa.bind(this);this.ob=this.Sa.bind(this);this.sb=this.Va.bind(this);this.rb=this.Ua.bind(this);this.v.addEventListener("click",this.mb,h);this.v.addEventListener("mousemove",this.qb,h);this.v.addEventListener("mouseup",
this.tb,h);this.v.addEventListener("mousedown",this.ob,h);this.v.addEventListener("mouseover",this.sb,h);this.v.addEventListener("mouseout",this.rb,h)}l=r.prototype;l.e=i();l.Ra=function(){this.nb=e};l.Ta=function(a){var b=this.ba,c=this.G.y;b.x=this.G.x;b.y=c;b=this.G;c=a.pageY-this.Y.y;b.x=a.pageX-this.Y.x;b.y=c;a=this.X;b=this.X.y+this.G.y-this.ba.y;a.x=this.X.x+this.G.x-this.ba.x;a.y=b};l.Wa=function(){this.F[0]=h};l.Sa=function(){this.F[0]=e};l.Va=function(){this.Ga=e};
l.Ua=function(){this.Ga=h;this.F[0]=h};function s(a){this.v=a;this.pb=new r(a);this.kb=new p}s.prototype.e=function(){this.pb.e();this.kb.e()};var t=f,o=f,u=f,v=0,w=f,x=f,y=f,z=f;function A(a){this.xb=a||0;this.input=y;this.Ca=h}A.prototype.c=function(){this.input=f};A.prototype.T=i();A.prototype.e=i();function B(){this.N=[]}B.prototype.c=function(){for(var a=this.N.length,b=0;b<a;++b){var c=this.N[b];c.cb.removeEventListener(c.ab,c.bb,c.$a)}this.N.length=0};function C(a,b,c,d){a.N.push({cb:b,ab:c,bb:d,$a:h});b.addEventListener(c,d,h)};function D(a){this.ready=h;this.name=a;this.Na=document.createElement("div");this.t=$(this.Na);this.t.attr("id","jzWrap_"+a);this.t.addClass("jzLayout");this.t.css("left","0px").css("top","0px");this.parentElement=f;this.aa=new B}D.prototype.c=function(){this.aa.c();this.aa=f;if(this.parent!=f)this.t.remove(),this.parent=f;this.Ab=this.Na=f};function E(a){this.W=e;this.ca=a}E.prototype.c=function(){this.Ja=f};function F(a){a.W=e;$(a.ca).removeClass("playTile-disabled").addClass("playTile")};function G(a){this.Ja=a;this.fb=$(a);this.R=8;this.f=[];for(a=0;a<this.R;++a){var b=this.fb.find("#p"+a);this.f.push(new E(b[0]))}}G.prototype.c=function(){for(var a=0;a<this.R;++a)this.f[a].c();this.f.length=0;this.Ja=f};function H(a,b){var c,b=b||f;c=c||"text";this.h=new XMLHttpRequest;this.La=f;this.h.open("GET",a,e);this.h.responseType=c;var d=this;this.h.onreadystatechange=function(){4===d.h.readyState&&(200===d.h.status?b!==f&&b(d.h.response,d.h.responseType):console.log("XMLHttpReq Error: ",d.h.statusText))}};function J(a,b){this.vb={p0:0,p1:1,p2:2,p3:3,p4:4,p5:5,p6:6,p7:7};this.U=0;this.na=1;this.m=a;this.lb=b;this.ready=h;this.Fa=f;this.z=new D("playboard");this.O=this.S.bind(this);this.Ia=this.Xa.bind(this);this.Aa=this.ma.bind(this);this.Ma=this.Za.bind(this);var c=new H(this.lb,this.O);c.h.send(c.La);this.i=this.g=this.p=this.f=this.l=f;this.k="";this.q=this.r=0;this.ga=[];this.enabled=h;this.fa=this.U}l=J.prototype;
l.c=function(){this.O=this.Fa=f;this.z.c();this.m=this.Ma=this.Aa=this.Ia=this.i=this.g=this.p=this.f=this.l=this.z=f};
l.S=function(a){this.Fa=a;var b=this.z;b.t.append(a);b.ready=e;a=this.z;b=document.getElementById("hudBeforeCanvas");a.parent=b;$(b).append(a.t);a=this.z.t;this.l=a.find("#infoText");this.f=a.find("#playTiles");this.p=a.find("#btn-cmd");this.g=a.find("#shelfTiles");this.i=a.find("#countdownText");this.da=new G(this.f[0]);a=this.z.aa;C(a,this.f[0],"mouseup",this.Ia);C(a,this.p[0],"click",this.Aa);C(a,this.g[0],"click",this.Ma);this.ready=e;K(this,this.r);this.p.text("I'm Ready");this.l.html("Are you ready? :)");
this.i.text(" ")};function K(a,b){a.r=b;var c=a.g.find("#r"+a.r);c.find(".shelfTile").removeClass("shelfTile-empty").removeClass("shelfTile-used").addClass("shelfTile-current");var d=a.k.length;if(0<d)for(var g=0;g<d;++g)c.find("#s"+g).text(a.k.charAt(g))}
l.Xa=function(a){if(this.enabled===e&&(a=this.vb[a.target.id],"undefined"!=typeof a&&!(4<this.q))){var b;b=this.da.f[a];b.W===e?(b.W=h,$(b.ca).removeClass("playTile").addClass("playTile-disabled"),b=""+$(b.ca).text()):b="";""!==b&&(this.k+=b,this.ga.push(a),this.g.find("#r"+this.r).find("#s"+this.q).text(b),this.q++,5===this.q&&this.ma())}};
function L(a,b){a.g.find(".shelfTile").removeClass("shelfTile-used").removeClass("shelfTile-current").addClass("shelfTile-empty").html("&nbsp;");for(var c=b.length,d=0;d<c;++d){var g=b[d],j=a.g.find("#r"+d);j.find(".shelfTile").removeClass("shelfTile-empty").removeClass("shelfTile-current").addClass("shelfTile-used").html("&nbsp;");for(var k=g.length,m=0;m<k;++m)j.find("#s"+m).text(g.charAt(m))}}
l.ma=function(){if(this.enabled!==e)this.m.L(e);else if(this.m.J(this.k)){this.k="";this.q=0;this.r=this.m.d.length;K(this,this.r);for(var a=this.da,b=0;b<a.R;++b)F(a.f[b]);this.ga.length=0}};
l.Za=function(){if(this.m.s.state===this.m.s.ra===e){var a=f;switch(this.fa){case this.U:a=this.m.Q();L(this,a);this.fa=this.na;break;case this.na:a=this.m.d.slice(0),L(this,a),this.fa=this.U}}else if(!(this.enabled!==e||0>=this.k.length))this.k=this.k.slice(0,-1),this.q--,this.g.find("#r"+this.r).find("#s"+this.q).html("&nbsp;"),a=this.ga.pop(),F(this.da.f[a])};function M(a,b){this.id=a;this.d=[];this.s=b;this.ub=h;this.u=[];this.P=[];this.Ka=99;this.Z=e;this.ready=h}l=M.prototype;l.ka=i();l.V=function(a){this.u=a.slice(0);this.ub=e};
l.J=function(a){var b=z;if(!(!b.ready?0:"undefined"!==typeof b.Ba[a]))return h;b=N(this,a);if(-1!==b)return h;a:{for(var b=this.P.length,c=0;c<b;++c)if(this.P[c]===a){b=c;break a}b=-1}if(-1!==b)return h;this.d.push(a);b=this.s;c=this.id;if(b.state===b.K){console.log("[zapGame] "+c+" has pushed: "+a);for(var d=-1,g=f,j=b.a.length,k=0;k<j;++k){var m=b.a[k];m.id===c?g=m:d=m.M(c,a)}-1!=d&&g!=f&&g.M(c,a);O(b,b.ta);if(b.elapsedTime<=1E3*b.va){j=b.a.length;for(k=0;k<j;++k)m=b.a[k],m.xa(c)}g!=f&&7<=g.d.length&&
b.w(c,h)}return e};l.w=function(){this.Z=e};l.o=function(){this.Z=h};l.M=function(a,b){var c=N(this,b);-1!==c&&(this.d.splice(c,1),this.P.push(b),console.log("--ZAPPED!-- ["+this.id+"] my word <"+b+"> was zapped by "+a));return c};function N(a,b){for(var c=a.d.length,d=0;d<c;++d)if(a.d[d]===b)return d;return-1}l.C=function(){return this.ready};l.L=function(a){this.ready=a};l.ia=i();l.wa=i();l.xa=i();l.e=i();l.Q=function(){return this.s.Q(this.id)};
l.c=function(){this.u.length=0;this.P.length=0;this.d.length=0;this.s=f};function P(a,b){M.call(this,a,b);this.ya=h;this.Ka=0;this.b=new J(this,"/jzap/Data/html/playboard.html")}P.prototype=new M;l=P.prototype;l.V=function(a){M.prototype.V.call(this,a);for(var b=this.b,c=0;8>c;++c)b.f.find("#p"+c).text(a[c])};l.J=function(a){if(M.prototype.J.call(this,a)===h)return h;L(this.b,this.d);return e};
l.M=function(a,b){var c=M.prototype.M.call(this,a,b);-1!==c&&(this.b.l.html(""+a+" has zapped the word "+b+"!!"),L(this.b,this.d),K(this.b,this.d.length));var d;a:{var g=this.s;d=g.a.length;for(var j=0;j<d;++j){var k=g.a[j];if(k.id!==this.id){d=k.d.length;break a}}d=-1}g=this.b;d=g.g.find("#r"+(d-1));g.g.find(".currentArrow").css("display","none");d.find(".currentArrow").css("display","block");return c};l.ia=function(a){this.b.i.text(""+Math.floor(a/1E3+1))};
l.wa=function(a){this.b.l.html("No new word has been made, counting down to end of game.");this.b.i.text(""+Math.floor(a/1E3+1))};l.xa=function(a){this.b.l.html("The countdown has been resetted by "+a);this.b.i.text(" ")};l.C=function(){return M.prototype.C.call(this)&&this.b.ready};l.L=function(a){M.prototype.L.call(this,a);this.b.p.text("...");if(this.ya===e)a=this.s,a.state=a.pa};
l.o=function(){M.prototype.o.call(this);this.b.i.text(" ");this.b.l.html("Go!");this.b.p.text("End Word");this.b.enabled=e};
l.w=function(a,b){M.prototype.w.call(this,a,b);this.ready=h;if(b===e){this.b.i.text(" ");this.b.l.html("Game Ended! It's a tie!");var c=parseInt($("#score0").text(),10)+1;$("#score0").text(""+c);c=parseInt($("#score1").text(),10)+1;$("#score1").text(""+c)}else{this.b.i.text(" ");this.b.l.html("Game Ended! The winner is "+a+"!");var c=this.id===a?"#score0":"#score1",d=parseInt($(""+c).text(),10)+1;$(""+c).text(""+d)}this.b.p.text("Next Game");this.b.enabled=h;this.ya=e};
l.c=function(){M.prototype.c.call(this);this.b.c()};function Q(a,b){M.call(this,""+a+"-bot",b);this.Ka=2;this.ja=2.05;this.ha=this.D=0;this.L(e)}Q.prototype=new M;Q.prototype.o=function(){M.prototype.o.call(this);this.ha=this.D+-1/this.ja*Math.log(Math.random())};Q.prototype.e=function(a){this.D+=1*a/1E3;if(this.Z!==e&&this.C()&&this.D>this.ha)this.ha=this.D+-1/this.ja*Math.log(Math.random()),a=3+Math.floor(3*Math.random()),5<a&&(a=5),this.J(ca(this,a))};
function ca(a,b){for(var c=a.u.slice(0),d="",g=0;g<b;++g){var j=Math.floor(Math.random()*c.length),d=d+c[j];c.splice(j,1)}return d};function R(a){this.qa=0;this.oa=1;this.K=2;this.ra=3;this.pa=4;this.Oa=3E3;this.ta=20;this.va=10;this.state=this.qa;this.elapsedTime=this.$=this.startTime=this.Da=f;this.id=a;this.ready=h;this.eb=f;this.u=[];this.a=[];this.sa=["A","E","I","O","U"];this.la="B,C,D,F,G,H,J,K,L,M,N,P,Q,R,S,T,V,W,X,Y,Z".split(",");this.yb="A,H,E,P,T,S,O,C".split(",")}function S(a,b,c){var d=f;switch(c){case 0:d=new P(b,a);break;case 2:d=new Q(b,a)}a.a.push(d)}l=R.prototype;l.ka=function(){this.u=da(this);this.ready=e};
function da(a){for(var b=[],c=[],d=h,g=2+Math.floor(2*Math.random()),j=0;j<g;++j){var k=a.sa[Math.floor(Math.random()*a.sa.length)];"U"===k&&(d=e);b.push(k)}g=8-b.length;k=h;for(j=0;j<g;++j){var m=a.la[Math.floor(Math.random()*a.la.length)];"Q"===m&&(k=e);c.push(m)}k===e&&d===h&&(b[Math.floor(Math.random()*b.length)]="U");a=b.concat(c);a.sort(function(){return 0.5-Math.random()});return a}function O(a,b){a.startTime=new Date;a.$=new Date(a.startTime.getTime()+1E3*b)}
l.C=function(){return this.ready&&T(this)};function T(a){for(var b=e,c=a.a.length,d=0;d<c;++d)var g=a.a[d],b=b&&g.C();return b}l.Q=function(a){for(var b=this.a.length,c=0;c<b;++c){var d=this.a[c];if(d.id!==a)return d.d.slice(0)}return[]};l.o=function(){for(var a=this.a.length,b=0;b<a;++b){var c=this.a[b];c.V(this.u);c.o()}this.state=this.K;O(this,this.ta)};l.w=function(a,b){for(var c=this.a.length,d=0;d<c;++d)this.a[d].w(a,b);this.state=this.ra};
l.e=function(a){switch(this.state){case this.qa:var b=T(this);$("#player0").text(this.a[0].id);$("#player1").text(this.a[1].id);if(b===e)this.state=this.oa,b=new Date,this.Da=b.getTime()+this.Oa;break;case this.oa:for(var b=new Date,b=this.Da-b.getTime(),c=this.a.length,d=0;d<c;++d){var g=this.a[d];g.ia(b)}if(0>=b)this.state=this.K,this.o();break;case this.K:this.elapsedTime=this.$.getTime()-(new Date).getTime();if(this.elapsedTime<=1E3*this.va){c=this.a.length;for(d=0;d<c;++d)g=this.a[d],g.wa(this.elapsedTime)}0>
this.elapsedTime&&(b=this.a.slice(0),b.sort(function(a,b){return b.d.length-a.d.length}),this.w(b[0].id,ea(this)))}c=this.a.length;for(d=0;d<c;++d)g=this.a[d],g.e(a)};function ea(a){for(var b=a.a.length,c=a.a[0].d.length,d=1;d<b;++d)if(a.a[d].d.length!==c)return h;return e}l.c=function(){this.eb=f;for(var a=this.a.length,b=0;b<a;++b)this.a[b].c();this.a.length=0;this.u.length=0;this.elapsedTime=this.$=this.startTime=f};function U(){A.call(this);this.id=(new Date).getTime();this.n=new R("game1234");S(this.n,"You",0);S(this.n,"Browser",2)}U.prototype=new A;U.prototype.c=function(){console.log("VsAiState["+this.id+"]: OnRelease");this.n.c();this.n=f;A.prototype.c.call(this)};U.prototype.T=function(){this.n.ka()};U.prototype.e=function(a){this.n.e(a);this.n.state===this.n.pa&&V(this)};function W(){A.call(this);this.id=(new Date).getTime();this.B=document.createElement("button");this.B.innerHTML="Play against the Browser-bot A.I.";this.Ha=document.createElement("button");this.Ha.innerHTML="vs Player";this.ea=this.Ya.bind(this)}W.prototype=new A;W.prototype.c=function(){console.log("GameModeSelectState["+this.id+"]: OnRelease");this.B.removeEventListener("click",this.ea,e);this.ea=f;$(this.B).remove();this.Ha=this.B=f;A.prototype.c.call(this)};
W.prototype.T=function(){var a=$("#hudBeforeCanvas");$(this.B).appendTo(a);this.B.addEventListener("click",this.ea,e)};W.prototype.e=i();W.prototype.Ya=function(){V(this)};function X(){this.O=this.S.bind(this);var a=new H("/jzap/Data/Words/dict_obj.json",this.O);a.h.send(a.La);this.Ba=f;this.ready=h}X.prototype.S=function(a){this.Ba=JSON.parse(a);this.ready=e};function Y(){this.stack=[];this.H=[]}function V(a){var b=t,c=new U;a.Ca=e;b.H.push(c)}Y.prototype.e=function(a){for(var b=this.stack.length-1;0<=b;--b){var c=this.stack[b];c.e(a);if(0===c.xb===e)break}b=this.stack.length;c=-1;for(a=0;a<b;++a){var d=this.stack[a];if(d.Ca){c=a;break}}if(-1!==c){for(a=b-1;a>=c;--a)d=this.stack[a],d.c();this.stack.splice(c,b-c)}b=this.H.length;for(a=0;a<b;++a)c=this.H[a],this.stack.push(c),c.T();if(0<b)this.H.length=0};(function(){for(var a=0,b=["ms","moz","webkit","o"],c=0;c<b.length&&!window.I;++c)window.I=window[b[c]+"RequestAnimationFrame"],window.za=window[b[c]+"CancelAnimationFrame"]||window[b[c]+"CancelRequestAnimationFrame"];if(!window.I)window.I=function(b){var c=(new Date).getTime(),j=Math.max(0,16-(c-a)),k=window.setTimeout(function(){b(c+j)},j);a=c+j;return k};if(!window.za)window.za=function(a){clearTimeout(a)}})();
function Z(a){var b=a-v;v=a;x.innerHTML="jZap - zap";t.e(b);u.save();u.setTransform(1,0,0,1,0,0);u.clearRect(0,0,o.width,o.height);u.restore();window.I(Z,f)}n("mainInit",function(){z=new X;o=document.getElementById("renderCanvas");u=o.getContext("2d");w=document.getElementById("renderArea");x=document.getElementsByTagName("title")[0];t=new Y;y=new s(w);new ba;var a=t,b=new W;a.H.push(b);window.I(Z,f)});n("mainLoop",Z);
